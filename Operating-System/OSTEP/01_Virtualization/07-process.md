# 🧠 프로세스의 개념 (OSTEP Chapter 7)

운영체제가 자원을 가상화하기 위해 가장 먼저 제공해야 하는 추상화는 **프로세스(Process)**이다. 프로세스는 실행 중인 프로그램을 의미하며, CPU와 메모리, 입출력 자원에 대한 접근과 상태 정보를 포함한 독립적인 실행 단위다. 이 장에서는 프로세스가 어떻게 만들어지고 관리되는지, 상태는 어떻게 변화하는지, 운영체제가 이를 어떻게 추적하고 제어하는지를 살펴본다.

---

## ❓ 핵심 질문

> CPU가 여러 개 존재하는 것처럼 보이게 하려면 어떻게 해야 할까?

---

## 🔍 상세 개념 정리

### 7.1 프로세스란?

- **프로세스(Process)**: 실행 중인 프로그램
- 구성 요소:
  - **주소 공간(Address Space)**: 실행 코드, 데이터, 스택, 힙 등
  - **레지스터 상태**: PC, SP, FP 등 하드웨어 상태 포함
  - **열려 있는 파일 목록** 등 운영체제가 관리하는 자원

> 운영체제는 **시분할(time sharing)** 을 통해 하나의 CPU로 여러 개의 프로세스가 동시에 실행되는 것처럼 만든다.

---

### 7.2 프로세스 API

| 기능 | 설명 |
|------|------|
| `Create` | 새 프로세스 생성 |
| `Destroy` | 프로세스 제거 |
| `Wait` | 다른 프로세스 종료 대기 |
| `Control` | 일시정지, 재개 등의 제어 |
| `Status` | 상태 확인 인터페이스 제공 |

> 현대 운영체제는 다양한 프로세스 API를 통해 사용자가 직접 또는 간접적으로 프로세스를 제어할 수 있도록 한다.

---

### 7.3 프로세스 생성 절차

운영체제가 프로그램을 **프로세스**로 만들기 위해 수행하는 단계:

1. **코드와 정적 데이터**를 메모리로 로딩
2. **스택(Stack)** 영역 생성 및 초기화 (`argc`, `argv`)
3. **힙(Heap)** 공간 설정 (예: `malloc`, `free`)
4. **입출력 초기화** (예: `STDIN`, `STDOUT`, `STDERR`)
5. **프로그램의 진입점(main)** 으로 분기 → 실행 시작

> 현대 OS는 **지연 로딩** 기법을 사용하여 실행 중 필요한 코드/데이터만 메모리에 탑재한다.

---

### 7.4 프로세스 상태

| 상태 | 설명 |
|------|------|
| `Running` | CPU에서 실행 중 |
| `Ready` | 실행 대기 중 |
| `Blocked` | 입출력 등 이벤트 대기 중 |

#### 🌀 상태 전이 예시
- `Ready → Running → Blocked → Ready → Running`
- 스케줄러가 이 전이를 관리

> 입출력 요청 중인 프로세스는 **Blocked**, 그 사이 다른 프로세스가 실행됨으로써 CPU 자원을 효율적으로 활용할 수 있다.

---

### 7.5 운영체제가 유지하는 자료 구조

- **Process List**: 현재 실행 중이거나 준비된 프로세스들을 관리
- **Process Control Block (PCB)**:
  - 메모리 크기
  - 상태
  - PID
  - 부모/자식 관계
  - 열린 파일 정보
  - 레지스터 상태 등

#### 💻 xv6 예시 구조
```c
struct proc {
  char *mem;
  uint sz;
  enum proc_state state;
  int pid;
  struct proc *parent;
  struct context context;
  ...
};
```

---

## ✅ 요약

- **프로세스**는 실행 중인 프로그램이며, 운영체제가 자원을 가상화하는 데 있어 가장 핵심적인 개념이다.
- 운영체제는 프로세스를 생성하고, 실행 상태를 관리하며, 다양한 시스템 콜 API를 통해 제어 가능하게 한다.
- 프로세스 상태, 메모리 구조, 입출력 구조 등 다양한 요소들이 프로세스를 구성하며, OS는 이들을 자료 구조를 통해 추적한다.
- 이 개념을 바탕으로 이후 CPU 가상화의 실제 메커니즘과 정책을 배울 준비를 마쳤다.

---

> 📚 출처: 『운영체제: 아주 쉬운 세 가지 이야기 (OSTEP)』
