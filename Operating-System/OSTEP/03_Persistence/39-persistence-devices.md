# 💾 I/O 장치 (OSTEP Chapter 39)

이 장에서는 **영속성(Persistence)** 을 제공하기 위한 핵심 구성 요소인 **I/O 장치(Device)** 를 설명한다.  
I/O 장치는 CPU, 메모리와 함께 컴퓨터 시스템을 구성하는 주요 하드웨어이며, 디스크와 같은 장치를 통해 데이터의 영속적 저장이 가능해진다.

---

## ❓ 핵심 질문

> 영속성이라는 시스템 기능을 제공하기 위해 **어떤 종류의 하드웨어가 필요하고**,  
> 운영체제는 이 장치들을 **어떻게 효율적으로 관리하는가?**

---

## 🔍 상세 개념 정리

---

### 39.1 시스템 구조

컴퓨터 시스템은 일반적으로 다음 3가지 주요 하드웨어 구성 요소로 이루어진다.

| 구성 요소 | 설명 |
|----------|------|
| CPU | 계산 및 처리 담당 |
| 메모리 | 임시 데이터 저장 |
| I/O 장치 | 외부 세계와 데이터 교환 |

이 장에서는 **I/O 장치**를 중심으로 다룬다.

---

### 39.2 표준 장치

일반적인 컴퓨터 시스템에서 사용되는 장치는 다음과 같다.

| 장치 종류 | 예시 |
|----------|------|
| 저장 장치(Storage) | 하드 디스크, SSD, USB 드라이브 |
| 네트워크 장치(Network) | 이더넷 카드, Wi-Fi 모듈 |
| 입력 장치(Input) | 키보드, 마우스 |
| 출력 장치(Output) | 모니터, 프린터 |

---

### 39.3 표준 방식

운영체제와 장치는 다음의 두 가지 방식으로 데이터를 교환한다.

| 방식 | 설명 |
|------|------|
| 메모리-매핑 방식(Memory-mapped I/O) | 장치를 메모리 공간처럼 접근 |
| 포트-매핑 방식(Port-mapped I/O) | 별도의 I/O 명령어로 장치 접근 |

대부분의 현대 시스템은 **메모리-매핑 방식**을 사용한다.

---

### 39.4 인터럽트를 이용한 CPU 오버헤드 개선

#### 폴링(Polling)의 문제점
- CPU가 장치 상태를 계속 확인해야 함 → **CPU 시간 낭비**

#### 인터럽트 방식
- 장치가 준비되었을 때 CPU에게 직접 알림
- CPU는 대기하지 않고 다른 작업 수행 가능

→ 인터럽트 방식이 CPU 효율성을 크게 향상시킨다.

---

### 39.5 DMA를 이용한 효율적인 데이터 이동

#### DMA(Direct Memory Access) 개념
- CPU를 거치지 않고 장치가 **메모리로 직접 데이터 전송**
- CPU는 전송 시작과 종료만 관리

#### 장점
- CPU 사용량 감소
- 데이터 전송 속도 향상

#### 동작 흐름
1. CPU가 DMA 컨트롤러에 전송 요청
2. DMA가 메모리와 장치 간 데이터 전송
3. 완료 후 CPU에 인터럽트 발생

---

### 39.6 디바이스와 상호작용하는 방법

장치에 따라 상호작용 방식이 다르다.

| 장치 유형 | 방식 |
|----------|------|
| 동기 장치(Synchronous Device) | 요청과 완료가 순서대로 발생 |
| 비동기 장치(Asynchronous Device) | 요청 후 완료 시점이 불확실 |

운영체제는 이를 고려하여 장치 제어 코드를 작성한다.

---

### 39.7 운영체제에 연결하기: 디바이스 드라이버

#### 디바이스 드라이버 역할
- 운영체제와 장치 간의 **중간 계층**
- 하드웨어 별로 다른 동작 방식을 **표준 인터페이스로 통일**

#### 운영체제와 드라이버의 분리
- 운영체제는 공통 인터페이스 제공
- 장치마다 드라이버가 개별 동작 구현

---

### 39.8 사례 연구: 간단한 IDE 디스크 드라이버

IDE 디스크는 고전적인 저장 장치로, 장치 제어 방법이 단순하다.

#### 초기화 과정
- 디스크 레지스터에 명령어 전송
- 데이터 버퍼 설정

#### 데이터 전송
- 읽기: 장치 → 메모리
- 쓰기: 메모리 → 장치

→ 실제 디스크 장치는 드라이버 코드로 직접 제어

---

### 39.9 역사상의 기록

#### 초창기 장치
- CPU가 직접 제어
- 효율성 낮음

#### 현대 장치
- DMA, 인터럽트 기반
- 드라이버로 관리

컴퓨터 아키텍처와 운영체제가 발전하면서 **장치 관리 효율이 향상**되었다.

---

### 39.10 요약

I/O 장치는 시스템 영속성의 핵심이다. 운영체제는 이를 효과적으로 관리하기 위해 다음 요소들을 사용한다.

| 기술 | 설명 |
|------|------|
| 메모리-매핑 | 장치를 메모리처럼 사용 |
| 인터럽트 | 장치 상태 알림 |
| DMA | 데이터 전송 효율 향상 |
| 디바이스 드라이버 | 운영체제와 장치 간의 중간 계층 |

---

> 📚 출처: 『운영체제: 아주 쉬운 세 가지 이야기 (OSTEP)』
