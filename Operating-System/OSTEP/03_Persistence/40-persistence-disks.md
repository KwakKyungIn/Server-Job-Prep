# 💿 하드 디스크 드라이브 (OSTEP Chapter 40)

이 장에서는 영속성 저장 장치로서 **하드 디스크 드라이브(Hard Disk Drive)** 가 어떤 구조와 동작 방식을 가지는지 설명한다.  
디스크는 데이터를 읽고 쓰는 기본적인 I/O 장치이며, 운영체제는 이 장치의 동작을 이해하고 효율적으로 제어해야 한다.

---

## ❓ 핵심 질문

> 하드 디스크 드라이브의 물리적 구조와 동작 방식은 어떠하며,  
> 운영체제는 이러한 하드웨어를 어떻게 효율적으로 제어할 수 있을까?

---

## 🔍 상세 개념 정리

---

### 40.1 인터페이스

디스크는 운영체제와 **블록 디바이스(block device)** 인터페이스를 통해 상호작용한다.  
운영체제는 디스크에 **블록 단위(block-based)로 읽고 쓰는 작업**을 요청한다.

| 인터페이스 유형 | 설명 |
|----------------|------|
| open(), close() | 디스크 장치 파일 열고 닫기 |
| read(), write() | 블록 단위 데이터 읽기/쓰기 |
| seek() | 특정 블록으로 이동 |

운영체제는 장치에 **물리적 위치(sector, track 등)** 대신 **블록 번호**로 접근한다.  
장치는 내부적으로 이를 물리 주소로 변환하여 처리한다.

---

### 40.2 기본 구조

디스크의 주요 구조는 다음과 같다.

| 구성 요소 | 설명 |
|----------|------|
| 플래터(platter) | 회전하는 원형 판 |
| 스핀들(spindle) | 플래터를 회전시키는 축 |
| 암(arm) | 플래터 위를 이동하는 구조 |
| 헤드(head) | 데이터를 읽고 쓰는 부위 |

플래터는 여러 면(surface)에 걸쳐 있으며, 각 면마다 독립적인 헤드가 있다.  
각 플래터는 트랙(track), 섹터(sector)로 구분되어 데이터를 저장한다.

#### 암과 헤드

**암(arm)** 은 플래터 위를 좌우로 이동하며, 헤드를 통해 데이터를 읽거나 쓴다.  
한 번에 하나의 트랙만 접근 가능하다.  
여러 플래터가 있으면, 모든 면에 있는 헤드가 동시에 같은 트랙에 위치한다.

---

---

### 40.3 간단한 디스크 드라이브

간단한 디스크 동작은 다음 3단계로 이루어진다.

1. **탐색(Seek):** 암을 원하는 트랙으로 이동
2. **회전 지연(Rotational delay):** 원하는 섹터가 헤드 아래 올 때까지 기다림
3. **데이터 전송(Transfer):** 데이터를 읽거나 씀

디스크의 성능은 주로 **탐색 시간과 회전 지연**에 의해 결정된다.  
데이터 전송 시간은 비교적 짧다.

---

### 40.4 그 외의 세부 사항

#### 버퍼링(Buffering)

디스크 내부에는 데이터를 임시 저장하는 **버퍼(buffer)** 가 존재한다.  
버퍼는 읽기 성능 향상 및 쓰기 캐싱 등에 사용된다.

#### 명령어 큐잉(Command Queuing)

디스크는 여러 명령어를 미리 받아 놓고, **효율적인 순서로 실행**한다.  
대표적 예: NCQ(Native Command Queuing)

#### I/O 병렬성

고급 디스크 드라이브는 다중 플래터, 다중 암 등을 통해 병렬 작업을 지원한다.

---

### 40.5 디스크 스케줄링

운영체제나 디스크 자체에서 디스크 I/O 요청을 최적의 순서로 처리한다.

#### FCFS (First-Come, First-Served)

- 요청이 도착한 순서대로 처리
- 구현은 쉽지만 비효율적
- 탐색 거리가 길어질 수 있음

#### SSTF (Shortest Seek Time First)

- 현재 위치에서 가장 가까운 트랙의 요청부터 처리
- 탐색 거리를 최소화하여 효율적
- 하지만 멀리 있는 요청이 굶주릴 수 있음 (**기아(starvation) 문제**)

#### SCAN (엘리베이터 알고리즘)

- 암이 한 방향으로 이동하며 요청 처리
- 끝까지 이동하면 방향 전환
- 공정성 증가, 응답 시간 예측 가능

#### C-SCAN (Circular SCAN)

- 한 방향으로만 이동하여 요청 처리
- 끝까지 가면 처음으로 돌아옴
- **모든 요청이 유사한 응답 시간**

#### LOOK 및 C-LOOK

- SCAN/C-SCAN의 변형
- 요청이 있는 범위까지만 이동 후 방향 전환

| 알고리즘 | 장점 | 단점 |
|---------|------|------|
| FCFS    | 단순 | 비효율적 탐색 |
| SSTF    | 효율적 탐색 | 기아 가능성 |
| SCAN    | 공정성 | 양 끝 요청이 유리 |
| C-SCAN  | 예측 가능 | 끝까지 이동 필요 |

---

### 40.6 요약

하드 디스크 드라이브는 컴퓨터 시스템의 **기본적인 영속성 저장 장치**다.  
운영체제는 디스크의 물리적 구조를 이해하고, 효율적인 I/O 처리를 위해 스케줄링, 버퍼링, 병렬성 등의 기술을 활용한다.

| 주요 요소 | 설명 |
|----------|------|
| 인터페이스 | 블록 단위 read/write |
| 구조 | 플래터, 암, 헤드로 구성 |
| 성능 요인 | 탐색 시간, 회전 지연 |
| 최적화 기술 | 버퍼링, 명령어 큐잉, 스케줄링 |

---

> 📚 출처: 『운영체제: 아주 쉬운 세 가지 이야기 (OSTEP)』
