# 🛡️ RAID (OSTEP Chapter 41)

이 장에서는 저장 장치의 영속성 및 신뢰성을 향상시키기 위한 대표적인 기술인 **RAID(Redundant Array of Independent Disks)** 를 설명한다.  
RAID는 다수의 하드 디스크 드라이브(HDD)를 조합하여 하나의 논리적 장치처럼 동작하도록 하며, **성능 향상, 고장 대비, 비용 효율성** 등을 고려한 다양한 수준(level)으로 구분된다.

---

## ❓ 핵심 질문

> 디스크가 고장날 경우 데이터 손실 없이 복구하려면 어떤 방법이 필요할까?  
> 성능과 비용, 신뢰성의 균형을 어떻게 맞출 수 있을까?

---

## 🔍 상세 개념 정리

---

### 41.1 인터페이스와 RAID의 내부

RAID는 외부적으로는 **단일 논리적 디스크**처럼 보이지만, 내부적으로는 여러 개의 물리 디스크로 구성된다.  
운영체제는 RAID를 일반적인 디스크처럼 인식하며, read/write 요청을 블록 단위로 보낸다.

RAID의 내부는 각 디스크에 데이터를 분산 저장하며, 일부 디스크에는 **오류 복구용 정보(패리티 또는 복제본)** 를 저장한다.  
이러한 구조는 고장 시 데이터를 복구할 수 있게 한다.

---

### 41.2 결함 모델

#### 단일 고장

RAID는 보통 **단일 디스크 고장**을 대비해 설계된다.  
어떤 하나의 디스크가 고장나더라도 전체 데이터가 손실되지 않고 복구 가능해야 한다.

#### 다중 고장

다수의 디스크가 동시에 고장나는 경우, RAID 수준에 따라 복구 불가능할 수도 있다.  
RAID 6 이상은 **2개 디스크 고장까지 복구 가능**하도록 설계된다.

---

### 41.3 RAID의 평가 방법

RAID를 평가할 때 고려하는 주요 요소는 다음과 같다.

| 평가 항목 | 설명 |
|-----------|------|
| 성능 | 읽기/쓰기 성능 |
| 용량 효율 | 전체 디스크 대비 유효 용량 비율 |
| 신뢰성 | 고장 발생 시 복구 가능성 |
| 비용 | 디스크 개수 및 복잡도 대비 성능 |

RAID의 각 레벨은 이 항목들 간의 트레이드오프(trade-off)로 설계된다.

---

### 41.4 RAID 레벨 0: 스트라이핑

#### 개념

- 데이터를 여러 디스크에 **순서대로 분산 저장**
- 성능 향상: 병렬 읽기/쓰기 가능
- 신뢰성 없음: 디스크 하나라도 고장나면 전체 데이터 손실

| 항목 | 설명 |
|------|------|
| 성능 | 매우 높음 |
| 용량 효율 | 100% |
| 신뢰성 | 없음 |

---

### 41.5 RAID 레벨 1: 미러링

#### 개념

- 모든 데이터를 **2개의 디스크에 동일하게 저장**
- 읽기 성능 향상: 병렬 읽기 가능
- 신뢰성 매우 높음: 하나의 디스크 고장 시 완전 복구 가능

| 항목 | 설명 |
|------|------|
| 성능 | 읽기 ↑, 쓰기 ↓ |
| 용량 효율 | 50% |
| 신뢰성 | 매우 높음 |

---

### 41.6 RAID 레벨 4: 패리티를 이용한 공간 절약

#### 개념

- 데이터를 여러 디스크에 저장하고, **하나의 디스크에 패리티(parity) 정보** 저장
- 하나의 디스크 고장 시 나머지 데이터와 패리티로 복구

| 항목 | 설명 |
|------|------|
| 성능 | 읽기 ↑, 쓰기 패리티 계산 필요 |
| 용량 효율 | (N-1)/N |
| 신뢰성 | 디스크 1개 고장 복구 가능 |

#### 쓰기 병목

- 모든 쓰기 시 패리티 디스크에 접근해야 하므로 **패리티 디스크가 병목**

---

### 41.7 RAID 레벨 5: 순환 패리티

#### 개념

- RAID 4의 병목 문제 해결
- **패리티 정보를 여러 디스크에 분산 저장**
- 병렬 쓰기 가능

| 항목 | 설명 |
|------|------|
| 성능 | 읽기/쓰기 모두 우수 |
| 용량 효율 | (N-1)/N |
| 신뢰성 | 디스크 1개 고장 복구 가능 |

---

### 41.8 RAID 비교: 정리

| 레벨 | 성능 | 용량 효율 | 신뢰성 |
|------|------|-----------|--------|
| RAID 0 | 최고 | 100% | 없음 |
| RAID 1 | 읽기↑, 쓰기↓ | 50% | 매우 높음 |
| RAID 4 | 읽기↑, 쓰기↓ | (N-1)/N | 높음 |
| RAID 5 | 읽기↑, 쓰기↑ | (N-1)/N | 높음 |

→ RAID 0은 성능만, RAID 1은 신뢰성만, RAID 5는 성능과 신뢰성의 균형

---

### 41.9 RAID와 관련된 다른 흥미로운 주제들

#### RAID 6

- **2개 디스크 고장까지 복구 가능**
- 복잡한 오류 정정 코드 사용 (ex: Reed-Solomon 코드)

#### 소프트웨어 vs 하드웨어 RAID

| 유형 | 설명 |
|------|------|
| 소프트웨어 RAID | 운영체제가 RAID 관리 |
| 하드웨어 RAID | 별도의 컨트롤러가 RAID 관리 |

#### 핫 스페어(hot spare)

- 미리 준비해둔 디스크
- 고장 발생 시 자동으로 교체

---

### 41.10 요약

RAID는 성능과 신뢰성을 동시에 만족하기 위한 디스크 배열 기술이다.  
각 레벨은 성능, 용량 효율, 신뢰성 간의 균형을 달리하여 사용된다.

| 레벨 | 성능 | 용량 효율 | 신뢰성 |
|------|------|-----------|--------|
| RAID 0 | 최고 | 100% | 없음 |
| RAID 1 | 읽기↑, 쓰기↓ | 50% | 매우 높음 |
| RAID 4 | 읽기↑, 쓰기↓ | (N-1)/N | 높음 |
| RAID 5 | 읽기↑, 쓰기↑ | (N-1)/N | 높음 |
| RAID 6 | 읽기↑, 쓰기↓ | (N-2)/N | 매우 높음 |

---

> 📚 출처: 『운영체제: 아주 쉬운 세 가지 이야기 (OSTEP)』
